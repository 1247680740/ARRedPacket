var views;!function(t){var e=function(){function t(t){GameConfig.shootNums=0,this.vec3=new Laya.Vector3(0,5,6),Laya.stage.removeChildByName("gameUI"),this.onCreateComplete(t)}return t.prototype.onCreateComplete=function(t){GameConfig.mainCamera.viewport=new Laya.Viewport(0,0,0,0),GameConfig.mainCamera.fieldOfView=0,this.camera2=new Laya.Camera,this.camera2.viewport=new Laya.Viewport(0,0,600,800),this.camera2.transform.rotate(new Laya.Vector3(-10,-180,0),!1,!1),this.camera2.transform.translate(new Laya.Vector3(0,2,0),!0),this.camera2.fieldOfView=90,GameConfig.mainScene.addChild(this.camera2),GameConfig.dogPos=new Laya.Vector3(0,-4,6),GameConfig.layaDog.transform.position=GameConfig.dogPos,GameConfig.ani.play("A_run"),"福袋"==t?(this.giftOBj=Laya.Sprite3D.load("res/fudai/fudai.lh"),this.giftOBj.name="bag",this.gather(this.giftOBj),Laya.timer.once(2e3,this,this.changeAni,[t,this.giftOBj.name])):"盒子"==t?(this.giftOBj=Laya.Sprite3D.load("res/gift/gift.lh"),this.giftOBj.name="box",this.gather(this.giftOBj),Laya.timer.once(2e3,this,this.changeAni,[t,this.giftOBj.name])):"红包"==t&&(this.giftOBj=Laya.Sprite3D.load("res/paket/paket.lh"),this.giftOBj.name="redBag",this.gather(this.giftOBj),Laya.timer.once(2e3,this,this.changeAni,[t,this.giftOBj.name]))},t.prototype.gather=function(t){GameConfig.mainScene.addChild(t),t.transform.position=this.vec3,t.transform.rotate(new Laya.Vector3(0,-90,0)),t.transform.localScale=new Laya.Vector3(12,12,12),Laya.timer.frameLoop(1,this,this.translatePos,[t]),Laya.timer.once(100,this,this.animate,[t])},t.prototype.translatePos=function(t){t.transform.position=this.vec3},t.prototype.changeAni=function(t,e){GameConfig.ani.play("A_jump"),Laya.timer.once(1e3,this,this.completeAni,[t,e])},t.prototype.animate=function(t){Laya.Tween.to(t.transform.position,{x:GameConfig.layaDog.transform.position.x,y:GameConfig.layaDog.transform.position.y,z:GameConfig.layaDog.transform.position.z},5e3)},t.prototype.completeAni=function(t,e){GameConfig.mainScene.removeChildByName(e),GameConfig.mainScene.removeChild(this.camera2),GameConfig.dogPos=new Laya.Vector3(0,-8,-8),GameConfig.layaDog.transform.position=GameConfig.dogPos,LayaAir3D.resetBG(t)},t}();t.SceneLayer=e}(views||(views={}));var utils;!function(t){var e=function(){function t(){}return t.selectItemFromArray=function(t){var e=t.length,a=parseInt(Math.random()*e+"");return t[a]},t.alterationNum=function(e){var a=Math.random();if(0==a)return t.alterationNum(e),void 0;for(var i="1",o=0;e>o;o++)i+="0";return a*parseInt(i)},t.createPrivateKey=function(t,e){void 0===e&&(e=""),""===e&&(e="bobo");var a,i=0,o=0;for(a=0;a<e.length;a++)o+=e.charCodeAt(a);for(a=0;a<t.length;a++)i+=t.charCodeAt(a)^o;return i},t.createRandomNumber=function(t){return parseInt(Math.random()*Math.pow(10,parseInt(t))+"")},t}();t.Hash=e}(utils||(utils={}));var nets;!function(t){var e=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.init=function(){this.socket=new Laya.Socket,this.socket.endian=Laya.Byte.LITTLE_ENDIAN,this.socket.connect("39.106.5.94",9555),this.socket.on(Laya.Event.OPEN,this,this.openHandler),this.socket.on(Laya.Event.MESSAGE,this,this.receiveHandler),this.socket.on(Laya.Event.CLOSE,this,this.closeHandler),this.socket.on(Laya.Event.ERROR,this,this.errorHandler)},t.prototype.openHandler=function(t){void 0===t&&(t=null),console.log("websocket connected!链接成功")},t.prototype.receiveHandler=function(t){void 0===t&&(t=null)},t.prototype.closeHandler=function(t){void 0===t&&(t=null),console.log("websocket disconnected!")},t.prototype.errorHandler=function(t){void 0===t&&(t=null),alert("参数错误")},t}();t.SocketManager=e}(nets||(nets={}));var nets;!function(t){var e=function(){function t(){}return t}();t.ResponseServer=e}(nets||(nets={}));var nets;!function(t){var e=function(){function e(t){if(null===t||t instanceof a==!1)throw new Error("HttpServiceProxy is singleton, not allow to use constructor!")}return e.getInstance=function(){return void 0===this.instance&&(this.instance=new e(new a)),this._apiRecord={},this.httpService=new t.HttpService,this.httpService.init(HttpConfig.host,HttpConfig.port,HttpConfig.path),this.httpService.callback=this.callback,this.instance},e.request=function(t,e,a,i){var o=new Object;if(o._api=this.saveApiRecord(t,a,i),null!=e){var n;for(n in e)o[n]=e[n]}this.httpService.request(this.handleJsonObject(o))},e.handleJsonObject=function(t){if(!t)return"";var e="",a=[],i=JSON.stringify(t);i=i.slice(1,i.length-1),a=i.split(",");for(var o=a.length,n="",r=[],s=0;o>s;s++)n=a[s],r=n.split(":"),e+=r[0]+"="+r[1],o-1>s&&(e+="&");return e=e.replace(/"/g,"")},e.saveApiRecord=function(t,e,a){var i=t;return this._apiRecord[i]={callback:e,takeData:a},i},e.callback=function(t){if(console.info("HttpServiceProxy, 响应回调成功..."),t&&t.hasOwnProperty("_api")){var a=t._api;if(null!=a&&null!=e._apiRecord[a]){var i=e._apiRecord[a].callback,o=e._apiRecord[a].takeData;null!==i&&(null===o?i(t):i(t,o)),e._apiRecord[a].callback=null,e._apiRecord[a].takeData=null,e._apiRecord[a]=null,delete e._apiRecord[a]}}},e}();t.HttpServiceProxy=e;var a=function(){function t(){}return t}()}(nets||(nets={}));var models;!function(t){var e=function(){function t(){}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.request_subInfo=function(t,e,a,i,o,n){HttpServiceProxy.request("addpacket.do",{name:t,nums:e,firstname:a,sex:i,province:o,city:n},this.getResponseInfo,{phone:e})},t.prototype.request_subCode=function(t){HttpServiceProxy.request("checkcode.do",{code:t},this.getResponseCode)},t.prototype.request_city=function(t){HttpServiceProxy.request("queryCity.do",{pid:t},this.getCityList)},t.prototype.getResponseInfo=function(t,e){if(t&&(t&&(this.receiveData=t),this.takeData=e,"ok"==this.receiveData.status)){var a=this.takeData.phone;GameConfig.prizeNum=a,laya.net.LocalStorage.setItem("phone",a)}},t.prototype.getResponseCode=function(t){if(t){t&&(this.receiveData=t);var e=this.receiveData;GameConfig.status=e.status}},t.prototype.getCityList=function(t){if(t){t&&(this.receiveData=t);var e,a=this.receiveData;this.cityStr="";var i;if("ok"===a.status){this.cityArr=a.content;for(var o=0;o<this.cityArr.length;o++)e=this.cityArr[o],i=e.name+",",this.cityStr=this.cityStr+i}this.cityStr=this.cityStr.substring(0,this.cityStr.length-1),console.log(this.cityStr),GameConfig.cityStr=this.cityStr}},t.prototype.handleCallback=function(e){t.callback&&(e?t.callback(e):t.callback())},t}();t.SubModel=e}(models||(models={}));var controllers;!function(t){var e=function(){function t(){t.subModel||(t.subModel=models.SubModel.getInstance())}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.subInfo=function(e,a,i,o,n,r){t.subModel.request_subInfo(e,a,i,o,n,r)},t.prototype.subCode=function(e){t.subModel.request_subCode(e)},t.prototype.getCity=function(e){t.subModel.request_city(e)},t}();t.SubCtrl=e}(controllers||(controllers={}));var configs;!function(t){var e=function(){function t(){}return t}();t.IdentityConfig=e}(configs||(configs={}));var configs;!function(t){var e=nets.HttpServiceProxy,a=function(){function t(){}return t.init=function(t,a,i,o){t&&(this.protocol=t),a&&(this.host=a),i&&(this.port=i),o&&(this.path=o),e.getInstance()},t.isset=function(e){return null==t._apiObject[e]?!1:!0},t.getSendData=function(e){return 0==t.isset(e)?null:this._apiObject[e].sendData},t.SERVER_CONNECTED="server_connected",t.RESULT_FORMAT="json",t._apiObject={subUserInfo:"addpacket.do"},t}();t.HttpConfig=a}(configs||(configs={}));var configs;!function(t){var e=function(){function t(){}return t.init=function(){},t.PC="PC",t.MOBILE="Mobile",t.GAME_VERSION="1.0.0",t.GAME_WINDOW_WIDTH=600,t.GAME_WINDOW_HEIGHT=800,t.layaDog=null,t.giftOpen=!1,t.isShoot=!1,t.shootNums=0,t.status=null,t.cityStr=null,t.prizeNum="",t}();t.GameConfig=e}(configs||(configs={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function i(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),BulletScript=function(t){function e(){var e=t.call(this)||this;return e.speedV3=new Laya.Vector3,e}return __extends(e,t),e.prototype._load=function(){this.bullet=this.owner},e.prototype.setShootDirection=function(t){this.speedV3=new Laya.Vector3(0,0,0);var e=new Laya.Vector3;Laya.Vector3.normalize(t,e),Laya.Vector3.scale(e,.15,this.speedV3)},e.prototype._update=function(){if(this.bullet.transform.translate(this.speedV3,!1),this.bullet.transform.position.z<-4.5||this.bullet.transform.position.z>4.5||this.bullet.transform.position.x>10||this.bullet.transform.position.x<-10||this.bullet.transform.position.y>10||this.bullet.transform.position.y<-10){this.bullet.removeSelf(),GameConfig.isShoot=!1;for(var t=0;t<GameConfig.spArr.length;t++){{var e=GameConfig.spArr[t],a=Math.abs(e.transform.position.x-this.bullet.transform.position.x),i=Math.abs(e.transform.position.y-this.bullet.transform.position.y),o=Math.abs(e.transform.position.z-this.bullet.transform.position.z),n=Math.floor(e.transform.position.y-10);new Laya.Vector3(e.transform.position.x,n,e.transform.position.z)}if(.5>a&&.5>i&&.6>o){Laya.SoundManager.playSound("res/music/boom.wav");var r=e.name;if(Laya.stage.getChildIndex(GameConfig.mainScene)<0)return;GameConfig.mainCamera.removeAllComponent(),Laya.Gyroscope.instance.offAll(Laya.Event.CHANGE),GameConfig.isShoot=!0;{new views.SceneLayer(r)}break}if(GameConfig.shootNums>=10){Laya.SoundManager.playSound("res/music/boom.wav");var s="盒子";if(Laya.stage.getChildIndex(GameConfig.mainScene)<0)return;GameConfig.mainCamera.removeAllComponent(),Laya.Gyroscope.instance.offAll(Laya.Event.CHANGE),GameConfig.isShoot=!0;{new views.SceneLayer(s)}return}}}},e}(Laya.Script),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function i(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),CubeScript=function(t){function e(){var e=t.call(this)||this;return e.isAttacked=!1,e.repelledV3=new Laya.Vector3,e.life=60,e}return __extends(e,t),e.prototype._load=function(){this.cube=this.owner},e.prototype.onTriggerEnter=function(t){var e=t.owner,a=e.getComponentByType(BulletScript);this.repelledV3=a.speedV3.clone(),Laya.Vector3.normalize(this.repelledV3,this.repelledV3),this.isAttacked=!0,console.log("\n1 子弹碰撞时位置(方向):",e.transform.position.elements)},e.prototype.onTriggerStay=function(t){var e=t.owner;console.log("2 子弹穿过时位置(方向):",e.transform.position.elements)},e.prototype.onTriggerExit=function(t){var e=t.owner;console.log("3 子弹穿出时位置(方向):",e.transform.position.elements),this.life-=20,this.life<=0&&(this.enable=!1,Laya.timer.frameOnce(1,this,function(){this.owner.destroy()}))},e.prototype._update=function(){this.isAttacked&&(this.cube.transform.translate(this.repelledV3,!1),Laya.Vector3.scale(this.repelledV3,.3,this.repelledV3),Laya.Vector3.scalarLength(this.repelledV3)<.01&&(this.isAttacked=!1))},e}(Laya.Script),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function i(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),VRCameraMoveScript=function(t){function e(){var e=t.call(this)||this;return e.q0=new Laya.Quaternion,e.q1=new Laya.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),e.q2=new Laya.Quaternion,e.q3=new Laya.Quaternion,e.q4=new Laya.Quaternion,e}return __extends(e,t),e.prototype._initialize=function(e){t.prototype._initialize.call(this,e),this.camera=e,Laya.Browser.window.addEventListener("deviceorientation",function(t){orientation=Laya.Browser.window.orientation||0,Laya.stage.canvasRotation&&(Laya.stage.screenMode==Laya.Stage.SCREEN_HORIZONTAL?this.orientation+=90:Laya.stage.screenMode==Laya.Stage.SCREEN_VERTICAL&&(this.orientation-=90)),Laya.Quaternion.createFromYawPitchRoll(t.alpha/360*Math.PI*2,t.beta/360*Math.PI*2,-t.gamma/360*Math.PI*2,this.q0),Laya.Quaternion.multiply(this.q0,this.q1,this.q2),Laya.Quaternion.createFromAxisAngle(Laya.Vector3.UnitZ,-orientation/360*Math.PI*2,this.q3),Laya.Quaternion.multiply(this.q2,this.q3,this.camera.transform.localRotation),this.camera.transform.localRotation.rotateY(-90,this.q4)}.bind(this),!1)},e.prototype._update=function(e){t.prototype._update.call(this,e),this.updateCamera(e.elapsedTime)},e.prototype.updateCamera=function(t){Laya.KeyBoardManager.hasKeyDown(87)&&this.camera.moveForward(-.002*t),Laya.KeyBoardManager.hasKeyDown(83)&&this.camera.moveForward(.002*t),Laya.KeyBoardManager.hasKeyDown(65)&&this.camera.moveRight(-.002*t),Laya.KeyBoardManager.hasKeyDown(68)&&this.camera.moveRight(.002*t),Laya.KeyBoardManager.hasKeyDown(81)&&this.camera.moveVertical(.002*t),Laya.KeyBoardManager.hasKeyDown(69)&&this.camera.moveVertical(-.002*t),this.updateRotation()},e.prototype.updateRotation=function(){this.camera.transform.localRotation=laya.utils.Browser.onAndriod?this.q4:this.camera.transform.localRotation},e}(Laya.Script),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function i(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),nets;!function(t){var e=laya.events.EventDispatcher,a=laya.net.HttpRequest,i=laya.events.Event,o=function(t){function e(){var e=t.call(this)||this;return e.protocolType="https://",e.sendDataType="post",e.receiveDataType="json",e.reqHeader=["Content-Type","application/json"],e}return __extends(e,t),e.prototype.init=function(t,e,o){this.url=this.protocolType+t+o,this.http=new a,this.http.on(i.START,this,this.startHandler),this.http.on(i.CLOSE,this,this.closeHandler),this.http.on(i.ERROR,this,this.httpErrorHandler),this.http.on(i.PROGRESS,this,this.httpProgrssHandler),this.http.on(i.COMPLETE,this,this.httpCompleteHandler)},e.prototype.request=function(t,e){e||(this.selfData=e);var a=t,i=a.indexOf("=")+1,o=a.indexOf("&"),n=a.substring(i,o);this.http.send(this.url+n,t,this.sendDataType,this.receiveDataType)},e.prototype.startHandler=function(t){console.log("HttpService, start, msg:"+t)},e.prototype.closeHandler=function(t){console.error("HttpService, close, msg:"+t)},e.prototype.httpErrorHandler=function(t){console.error("HttpService, has error:"+t)},e.prototype.httpProgrssHandler=function(t){var e;t&&(e=100*t+"%"),console.log("HttpService, progress is:"+e)},e.prototype.httpCompleteHandler=function(){if(this.receiveData=this.http.data,console.info("HttpService, httpCompleteHandler, receive data:\n"+JSON.stringify(this.receiveData)),"string"==typeof this.receiveData)try{this.receiveData=JSON.parse(this.receiveData)}catch(t){console.error("HttpService, httpCompleteHandler, catch error: "+t)}"ok"==this.receiveData.status?this.callback&&(this.selfData?this.callback(this.receiveData,this.selfData):this.callback(this.receiveData)):console.error("HttpService, msg:"+this.receiveData.status)},e}(e);t.HttpService=o}(nets||(nets={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function i(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),View=laya.ui.View,Dialog=laya.ui.Dialog,ui;!function(t){var e=function(e){function a(){return e.call(this)||this}return __extends(a,e),a.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.createView(t.mainUIUI.uiView)},a.uiView={type:"View",props:{width:600,height:800,centerY:0,centerX:0},child:[{type:"Image",props:{width:88,skin:"imgs/post.png",height:88,centerY:0,centerX:0}}]},a}(View);t.mainUIUI=e}(ui||(ui={})),function(t){var e=function(e){function a(){return e.call(this)||this}return __extends(a,e),a.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.createView(t.PrizePageUI.uiView)},a.uiView={type:"View",props:{width:600,height:800},child:[{type:"Image",props:{width:605,skin:"imgs/bg.png",height:1076,centerY:2,centerX:4}},{type:"Label",props:{y:710,width:576,text:"请至前台处领取红包",height:37,fontSize:30,font:"Helvetica",color:"#ffffff",centerX:0,bold:!1,align:"center"}},{type:"Box",props:{"var":"topBg",name:"topBg"},child:[{type:"Image",props:{width:608,skin:"imgs/di.png",height:129}},{type:"Image",props:{y:27,x:333,skin:"imgs/logo_text.png"}},{type:"Image",props:{y:20,x:101,skin:"imgs/theLogo.png"}}]},{type:"Image",props:{width:371,skin:"imgs/packet.png",height:362,centerY:16,centerX:0}}]},a}(View);t.PrizePageUI=e}(ui||(ui={})),function(t){var e=function(e){function a(){return e.call(this)||this}return __extends(a,e),a.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.createView(t.RedBagFirstUI.uiView)},a.uiView={type:"View",props:{width:600,height:800,centerY:0,centerX:0},child:[{type:"Image",props:{width:523,skin:"imgs/red.png",height:706,centerY:0,centerX:1}}]},a}(View);t.RedBagFirstUI=e}(ui||(ui={})),function(t){var e=function(e){function a(){return e.call(this)||this}return __extends(a,e),a.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.createView(t.RedBagOpenUI.uiView)},a.uiView={type:"View",props:{y:0,x:0,width:600,height:800,centerY:0,centerX:0},child:[{type:"Image",props:{width:605,skin:"imgs/bg.png",height:1076,centerY:0,centerX:0}},{type:"Image",props:{y:137,width:431,skin:"imgs/centerBg.png",height:665,centerX:0}},{type:"Image",props:{y:143,width:431,skin:"imgs/tishi.png",height:60,centerX:0}},{type:"Image",props:{y:233,x:184,skin:"imgs/name.png"}},{type:"Image",props:{y:376,x:182,skin:"imgs/phone.png"}},{type:"Button",props:{y:663,width:243,"var":"submit",stateNum:1,skin:"imgs/sub.png",name:"submit",mouseThrough:!0,mouseEnabled:!0,height:58.5,centerX:0}},{type:"TextInput",props:{y:216,width:270,"var":"userName",type:"text",skin:"imgs/input.png",promptColor:"#c3acaa",prompt:"姓氏",name:"userName",height:61,fontSize:25,font:"Microsoft YaHei",color:"#ffffff",centerX:0,bold:!0,align:"center"}},{type:"RadioGroup",props:{y:309,width:251,"var":"radioCheck",space:55,skin:"comp/radio.png",name:"radioCheck",labels:"先生,女士",labelStroke:1,labelSize:25,labelPadding:"-6,2,2,6",labelFont:"Helvetica",labelColors:"#7d6d6d,#7d6d6d,#ffffff,#7d6d6d",labelAlign:"left",height:55,centerX:25}},{type:"TextInput",props:{y:362,width:270,"var":"phoneNum",type:"number",skin:"imgs/input.png",promptColor:"#c3acaa",prompt:"手机号码",name:"phoneNum",maxChars:11,height:61,fontSize:25,font:"Microsoft YaHei",color:"#ffffff",centerX:0,bold:!0,align:"center"}},{type:"ComboBox",props:{y:459,width:270,visibleNum:8,"var":"province",skin:"imgs/111.png",sizeGrid:"4,20,4,4",selectedIndex:0,scrollBarSkin:"comp/vscroll.png",name:"province",labels:"请选择省份,北京市,天津市,上海市,重庆市,河北省,山西省,台湾省,辽宁省,吉林省,黑龙江省,江苏省,浙江省,安徽省,福建省,江西省,山东省,河南省,湖北省,湖南省,广东省,甘肃省,四川省,贵州省,海南省,云南省,青海省,陕西省,广西壮族自治区,西藏自治区,宁夏回族自治区,新疆维吾尔族自治区,内蒙古自治区,澳门特别行政区,香港特别行政区",labelSize:25,labelFont:"Helvetica",labelColors:"#c3acaa,#c3acaa,#c3acaa,#c3acaa",labelBold:!0,itemSize:32,itemColors:"#7d6d6d,#7d6d6d,#7d6d6d,#7d6d6d",height:61,centerX:0}},{type:"ComboBox",props:{y:557,width:270,visibleNum:5,"var":"cityList",skin:"imgs/111.png",sizeGrid:"4,20,4,4",selectedIndex:0,scrollBarSkin:"comp/vscroll.png",name:"cityList",labels:"城市",labelSize:25,labelFont:"Helvetica",labelColors:"#c3acaa,#c3acaa,#c3acaa,#c3acaa",labelBold:!0,itemSize:32,itemColors:"#7d6d6d,#7d6d6d,#7d6d6d,#7d6d6d",height:61,centerX:0}},{type:"Box",props:{x:-3,"var":"topBg",name:"topBg"},child:[{type:"Image",props:{width:608,skin:"imgs/di.png",height:129}},{type:"Image",props:{y:27,x:333,skin:"imgs/logo_text.png"}},{type:"Image",props:{y:20,x:101,skin:"imgs/theLogo.png"}}]}]},a}(View);t.RedBagOpenUI=e}(ui||(ui={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function i(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),views;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(ui.mainUIUI);t.GameMain=e}(views||(views={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function i(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),views;!function(t){var e=controllers.SubCtrl,a=t.GameMain,i=function(i){function o(t){var e=i.call(this)||this;return e.flag=!1,e.message="",e.myreg=/^(((13[0-9]{1})|(14[0-9]{1})|(17[0-9]{1})|(15[0-3]{1})|(15[4-9]{1})|(18[0-9]{1})|(199))+\d{8})$/,laya.utils.Browser.onAndriod?e.topBg.top=-80:laya.utils.Browser.onIOS&&(e.topBg.top=-50),e.timeNum=60,e.name="openView",Laya.stage.addChild(e),e.x=0,e.province.on(Laya.Event.CHANGE,e,e.getCityList),e.cityList.on(Laya.Event.CHANGE,e,e.changeColor),e.submit.on(Laya.Event.MOUSE_DOWN,e,e.subUserInfo,[t]),e}return __extends(o,i),o.prototype.subUserInfo=function(t){return""==this.userName.text||-1==this.radioCheck.selectedIndex||"请选择省份"==this.province.selectedLabel||"城市"==this.cityList.selectedLabel||""==this.phoneNum.text?(alert("信息还未填写完整！"),void 0):this.phoneNum.text==laya.net.LocalStorage.getItem("phone")?(alert("你已经提交过信息了！"),void 0):(this.phoneNums=this.phoneNum.text,""==this.phoneNums?(this.message="手机号码不能为空！",this.alertMessage(this.message)):11!=this.phoneNums.length?(this.message="请输入11位手机号码！",this.alertMessage(this.message)):this.myreg.test(this.phoneNums)?(this.firstname=this.userName.text,this.sex=0==this.radioCheck.selectedIndex?"先生":"女士",this.flag=!0,e.getInstance().subInfo(t,this.phoneNums,this.firstname,this.sex,this.province.selectedLabel,this.cityList.selectedLabel),this.changePage(t)):(this.message="请输入有效的手机号码！",this.alertMessage(this.message)),void 0)},o.prototype.alertMessage=function(t){""!=t&&alert(t)},o.prototype.getCityList=function(){if("请选择省份"==this.province.selectedLabel)this.cityList.labels="城市",this.cityList.selectedIndex=0;else{this.province.labelColors="#ffffff,#c3acaa,#c3acaa,#c3acaa";var t=this.province.selectedIndex;e.getInstance().getCity(t),Laya.timer.once(1e3,this,function(){this.cityList.labels=GameConfig.cityStr,this.cityList.selectedIndex=0})}},o.prototype.changePage=function(e){this.visible=!1,Laya.stage.removeChild(this);new t.PrizeView(e)},o.prototype.changeColor=function(){this.cityList.labelColors="#ffffff,#c3acaa,#c3acaa,#c3acaa"},o.prototype.resetPage=function(){if(GameConfig.cityStr="",this.cityList.labels="",this.visible=!1,Laya.stage.removeChild(this),Laya.stage.getChildByName("gameUI"))return console.log("已经有瞄准镜了"),void 0;var t=new a;t.name="gameUI",Laya.stage.addChild(t),LayaAir3D.prototype.openCamera(),GameConfig.mainCamera.addComponent(VRCameraMoveScript),Laya.timer.once(1e3,this,function(){GameConfig.isShoot=!1,GameConfig.giftOpen=!1})},o}(ui.RedBagOpenUI);t.OpenView=i}(views||(views={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function i(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),views;!function(t){var e=laya.display.Sprite,a=laya.utils.Browser,i=laya.resource.Texture,o=function(o){function n(){var t=o.call(this)||this;return t.timeNum=1,t.sp=new e,Laya.stage.addChild(t),laya.utils.Browser.onAndriod&&(t.topBg.top=-16,t.x=-2,t.y=16),t}return __extends(n,o),n.prototype.changePage=function(e){this.visible=!1,Laya.stage.removeChild(this);new t.OpenView(e)},n.prototype.screenShot=function(){var t=this;Laya.timer.loop(1e3,this,function(){if(t.timeNum++,t.timeNum>2){Laya.timer.clearAll(t);var o=t.drawToCanvas(a.width,a.height,0,0),n=o.getCanvas(),r=(n.toDataURL(),new i(o)),s=new e;s.graphics.drawTexture(r,0,0,700,1e3),s.x=10,Laya.stage.addChild(s)}})},n}(ui.PrizePageUI);t.PrizeView=o}(views||(views={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function i(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),views;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.name="firstView",laya.utils.Browser.onIOS&&Laya.stage.on(Laya.Event.MOUSE_DOWN,a,LayaAir3D.resetBG,[e]),a}return __extends(e,t),e}(ui.RedBagFirstUI);t.RedBagFirst=e}(views||(views={}));var OpenView=views.OpenView,GameMain=views.GameMain,GameConfig=configs.GameConfig,HttpConfig=configs.HttpConfig,IdentityConfig=configs.IdentityConfig,HttpServiceProxy=nets.HttpServiceProxy,SocketManeger=nets.SocketManager,Handler=laya.utils.Handler,LayaAir3D=function(){function t(){this.isRun=!1,this.intAlpha=800,this.dogP=0,this.alphaN=0,this.gammaN=0,Laya3D.init(GameConfig.GAME_WINDOW_WIDTH,GameConfig.GAME_WINDOW_HEIGHT,!0,!0),1==Laya.Render.isWebGL?(Laya.stage.bgColor="none",Config.isAlpha=!0):Laya.stage.bgColor=null,Laya.stage.mouseEnabled=!0,Laya.stage.scaleMode=Laya.Stage.SCALE_FIXED_AUTO,Laya.stage.screenMode=Laya.Stage.SCREEN_VERTICAL,Laya.stage.alignH=Laya.Stage.ALIGN_CENTER,Laya.stage.alignV=Laya.Stage.ALIGN_MIDDLE,t.instance=this,Laya.loader.create([{url:"res/atlas/imgs.atlas",type:Laya.Loader.ATLAS},{url:"res/atlas/comp.atlas",type:Laya.Loader.ATLAS},{url:"res/LayaDog/minidog.lh",type:Laya.Sprite3D},{url:"res/fudai/fudai.lh",type:Laya.Sprite3D},{url:"res/gift/gift.lh",type:Laya.Sprite3D},{url:"res/paket/paket.lh",type:Laya.Sprite3D},{url:"res/firework/firework.lh",type:Laya.Sprite3D}],Laya.Handler.create(this,this.dataInit))}return t.prototype.dataInit=function(){this.musicPlay(),this.openCamera(),GameConfig.spArr=new Array,this.oldArr=new Array,this.cVec=new Laya.Vector3(0,-90,0),GameConfig.dogPos=new Laya.Vector3(0,-10,-10),GameConfig.ray=new Laya.Ray(new Laya.Vector3,new Laya.Vector3),GameConfig.rayCastHit=new Laya.RaycastHit,Laya.Gyroscope.instance.on(Laya.Event.CHANGE,this,this.onMotoin),this.connetService()},t.prototype.connetService=function(){var t;t={protocol:"https",host:"www.secsplus.com",port:8080,path:"/redpacket/pacontro/",platform:"mmc"},HttpConfig.init(t.protocol+"://",t.host,t.port,t.path),this.createAdapter()},t.prototype.openCamera=function(){t.video=document.createElement("video"),t.video.setAttribute("autoplay",""),t.video.setAttribute("muted",""),t.video.setAttribute("playsinline",""),t.video.style.width=laya.utils.Browser.width,t.video.style.height=laya.utils.Browser.height,Laya.Browser.onAndriod?t.video.addEventListener("click",function(){t.onShoot()},!0):Laya.Browser.onIOS?Laya.stage.on(Laya.Event.MOUSE_DOWN,this,t.onShoot):t.video.addEventListener("click",function(){t.onShoot()},!0);var e=function(t){console.log("Webcam Error\nName: "+t.name+"\nMessage: "+t.message)};if(void 0===navigator.mediaDevices||void 0===navigator.mediaDevices.enumerateDevices||void 0===navigator.mediaDevices.getUserMedia){if(void 0===navigator.mediaDevices)var a="navigator.mediaDevices";else if(void 0===navigator.mediaDevices.enumerateDevices)var a="navigator.mediaDevices.enumerateDevices";else if(void 0===navigator.mediaDevices.getUserMedia)var a="navigator.mediaDevices.getUserMedia";else console.assert(!1);return e({name:"",message:"WebRTC issue-! "+a+" not present in your browser"}),null}navigator.mediaDevices.enumerateDevices().then(function(){var e={audio:!1,video:{facingMode:"environment"}};navigator.mediaDevices.getUserMedia(e).then(function(e){t.video.srcObject=e,t.video.play();var a=setInterval(function(){t.video.videoWidth&&(laya.utils.Browser.document.body.appendChild(t.video),clearInterval(a))},20)})}).catch(function(t){e({message:t.message})})},t.prototype.createAdapter=function(){GameConfig.mainScene=new Laya.Scene,Laya.stage.addChild(GameConfig.mainScene),GameConfig.mainCamera=new Laya.Camera(0,.1,20),GameConfig.mainScene.addChild(GameConfig.mainCamera),GameConfig.mainCamera.transform.translate(new Laya.Vector3(0,0,3)),GameConfig.mainCamera.addComponent(VRCameraMoveScript);var t=GameConfig.mainCamera.addChild(new Laya.DirectionLight);t.transform.translate(new Laya.Vector3(0,7,-5)),t.direction=new Laya.Vector3(0,0,-5),t.diffuseColor=new Laya.Vector3(.6,.6,.6),this.onCreateComplete(),this.gameUI=new GameMain,this.gameUI.name="gameUI",Laya.stage.addChild(this.gameUI)},t.prototype.onCreateComplete=function(){new Laya.Vector3(0,0,0);GameConfig.layaDog=Laya.Sprite3D.load("res/LayaDog/minidog.lh"),GameConfig.layaDog.transform.localScale=new Laya.Vector3(10,10,10),GameConfig.mainScene.addChild(GameConfig.layaDog),GameConfig.layaDog.transform.position=new Laya.Vector3(0,-8,-8),Laya.timer.frameLoop(1,this,this.resetDogPosition),GameConfig.ani=GameConfig.layaDog.getChildAt(0)._components[0];for(var t=0;15>t;t++)this.createObj(t);this.animate(),Laya.timer.loop(7e3,this,this.animate)},t.prototype.musicPlay=function(){Laya.SoundManager.playSound("res/music/barking.wav")},t.prototype.onMotoin=function(e,a){if(null==a.alpha)return alert("当前设备不支持陀螺仪"),Laya.Gyroscope.instance.off(Laya.Event.CHANGE,this,this.onMotoin),void 0;if(this.alphaN=a.alpha,t.betaN=a.beta,this.gammaN=a.gamma,this.intAlpha>1&&(this.intAlpha=Math.floor(a.alpha)),t.dogRotation=Math.floor(a.alpha)-this.intAlpha,0==this.isRun&&null!=GameConfig.layaDog){var i=GameConfig.layaDog;if((t.dogRotation>15||t.dogRotation<-300&&t.dogRotation>-345)&&-1!=this.dogP){GameConfig.ani.play("A_run"),i.transform.rotate(new Laya.Vector3(0,80,0)),Laya.Tween.to(GameConfig.layaDog.transform.position,{x:-8,y:GameConfig.layaDog.transform.position.y,z:GameConfig.layaDog.transform.position.z},2e3,Laya.Ease.linearIn,Laya.Handler.create(this,this.dogIdle)),this.isRun=!0,this.dogP=-1;var o=Math.random();o>.8&&Laya.SoundManager.playSound("res/music/barking.wav")}else if((t.dogRotation<-15||t.dogRotation>300&&t.dogRotation<345)&&1!=this.dogP){GameConfig.ani.play("A_run"),i.transform.rotate(new Laya.Vector3(0,-80,0)),Laya.Tween.to(GameConfig.layaDog.transform.position,{x:8,y:GameConfig.layaDog.transform.position.y,z:GameConfig.layaDog.transform.position.z},2e3,Laya.Ease.linearIn,Laya.Handler.create(this,this.dogIdle)),this.isRun=!0,this.dogP=1;var o=Math.random();o>.8&&Laya.SoundManager.playSound("res/music/barking.wav")}}},t.prototype.dogIdle=function(){GameConfig.ani.play("B_idle"),this.isRun=!1,GameConfig.layaDog.transform.rotation=new Laya.Quaternion(0,0,0,-1)},t.prototype.createObj=function(){var t=Math.floor(3*Math.random()),e=Math.random()>.5?1:-1;this.math1=3*Math.random()*e,this.math2=10*Math.random()-3,this.math3=-5,this.oldVec=new Laya.Vector3(this.math1,this.math2,this.math3),this.oldArr.push(this.oldVec);var a=Laya.Sprite3D.load("res/fudai/fudai.lh"),i=Laya.Sprite3D.load("res/gift/gift.lh"),o=Laya.Sprite3D.load("res/paket/paket.lh");switch(t){case 0:this.layaGift_clone1=GameConfig.mainScene.addChild(Laya.Sprite3D.instantiate(a,null,!1,new Laya.Vector3(this.oldVec.x,this.oldVec.y,this.oldVec.z))),this.layaGift_clone1.transform.position=this.oldVec,this.layaGift_clone1.name="福袋",this.jihe(this.layaGift_clone1);break;case 1:this.layaGift_clone2=GameConfig.mainScene.addChild(Laya.Sprite3D.instantiate(i,null,!1,new Laya.Vector3(this.oldVec.x,this.oldVec.y,this.oldVec.z))),this.layaGift_clone2.transform.position=this.oldVec,this.layaGift_clone2.name="盒子",this.jihe(this.layaGift_clone2);
break;case 2:this.layaGift_clone3=GameConfig.mainScene.addChild(Laya.Sprite3D.instantiate(o,null,!1,new Laya.Vector3(this.oldVec.x,this.oldVec.y,this.oldVec.z))),this.layaGift_clone3.transform.position=this.oldVec,this.layaGift_clone3.name="红包",this.jihe(this.layaGift_clone3)}},t.prototype.jihe=function(t){t.transform.localScale=new Laya.Vector3(4,4,4),GameConfig.spArr.push(t),Laya.timer.frameLoop(1,this,this.resetPosition)},t.prototype.resetPosition=function(){for(var t=0;t<GameConfig.spArr.length;t++){var e=GameConfig.spArr[t];e.transform.position=this.oldArr[t]}},t.prototype.resetDogPosition=function(){GameConfig.layaDog.transform.position=GameConfig.dogPos},t.prototype.animate=function(){for(var t=0;t<GameConfig.spArr.length;t++){var e=GameConfig.spArr[t],a=Math.random()>.5?1:-1,i=(3*Math.random()+5)*a,o=10*Math.random()-3,n=-5;this.newVec=new Laya.Vector3(i,o,n),Laya.Tween.to(e.transform.position,{x:i,y:o,z:n},7e3)}},t.onShoot=function(){if(GameConfig.shootNums++,!GameConfig.isShoot&&!GameConfig.giftOpen){GameConfig.isShoot=!0,Laya.SoundManager.playSound("res/music/shoot.wav");var e=Laya.Sprite3D.load("res/firework/firework.lh"),a=GameConfig.mainScene.addChild(Laya.Sprite3D.instantiate(e,null,!1,new Laya.Vector3(0,-1,3)));a.transform.scale=new Laya.Vector3(3,3,3),a.transform.rotate(new Laya.Vector3(t.betaN-145,t.dogRotation,0),!0,!1);var i=a.addComponent(BulletScript);GameConfig.mousePos=new Laya.Vector2(Laya.stage.width/2,Laya.stage.height/2.2),GameConfig.mainCamera.viewportPointToRay(GameConfig.mousePos,GameConfig.ray),Laya.Physics.rayCast(GameConfig.ray,GameConfig.rayCastHit,30,0);var o=new Laya.Vector3;if(-1!==GameConfig.rayCastHit.distance)Laya.Vector3.subtract(GameConfig.rayCastHit.position,a.transform.position,o),i.setShootDirection(o);else{var n=new Laya.Vector3;Laya.Vector3.scale(GameConfig.ray.direction,GameConfig.mainCamera.farPlane,n);var r=new Laya.Vector3;Laya.Vector3.subtract(GameConfig.mainCamera.transform.position,a.transform.position,r),Laya.Vector3.add(n,r,o),i.setShootDirection(o)}}},t.resetBG=function(e){GameConfig.giftOpen=!0,Laya.stage.offAll(Laya.Event.MOUSE_DOWN),laya.utils.Browser.document.body.removeChild(t.video);new views.OpenView(e)},t.dogRotation=0,t.betaN=0,t}();new LayaAir3D;